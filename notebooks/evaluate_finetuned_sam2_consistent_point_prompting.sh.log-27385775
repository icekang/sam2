/home/gridsan/nchutisilp/.conda/envs/sam2/bin/python
/home/gridsan/nchutisilp/projects/segment-anything-2/sam2/modeling/sam/transformer.py:23: UserWarning: Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
  OLD_GPU, USE_FLASH_ATTN, MATH_KERNEL_ON = get_sdpa_settings()
frame loading (JPEG):   0%|                                                             | 0/375 [00:00<?, ?it/s]frame loading (JPEG):   0%|▏                                                    | 1/375 [00:00<04:41,  1.33it/s]frame loading (JPEG):   1%|▌                                                    | 4/375 [00:00<01:04,  5.76it/s]frame loading (JPEG):   2%|▉                                                    | 7/375 [00:01<00:39,  9.26it/s]frame loading (JPEG):   3%|█▍                                                  | 10/375 [00:01<00:30, 11.97it/s]frame loading (JPEG):   4%|█▉                                                  | 14/375 [00:01<00:22, 16.37it/s]frame loading (JPEG):   5%|██▎                                                 | 17/375 [00:01<00:19, 17.93it/s]frame loading (JPEG):   5%|██▊                                                 | 20/375 [00:01<00:19, 17.78it/s]frame loading (JPEG):   6%|███▏                                                | 23/375 [00:01<00:18, 18.96it/s]frame loading (JPEG):   7%|███▌                                                | 26/375 [00:01<00:18, 19.31it/s]frame loading (JPEG):   8%|████                                                | 29/375 [00:02<00:16, 21.30it/s]frame loading (JPEG):   9%|████▍                                               | 32/375 [00:02<00:16, 20.37it/s]frame loading (JPEG):   9%|████▊                                               | 35/375 [00:02<00:15, 21.33it/s]frame loading (JPEG):  10%|█████▎                                              | 38/375 [00:02<00:17, 19.15it/s]frame loading (JPEG):  11%|█████▋                                              | 41/375 [00:02<00:18, 18.09it/s]frame loading (JPEG):  12%|██████▏                                             | 45/375 [00:02<00:15, 21.36it/s]frame loading (JPEG):  13%|██████▋                                             | 48/375 [00:02<00:16, 20.12it/s]frame loading (JPEG):  14%|███████                                             | 51/375 [00:03<00:15, 21.02it/s]frame loading (JPEG):  14%|███████▍                                            | 54/375 [00:03<00:13, 22.97it/s]frame loading (JPEG):  15%|███████▉                                            | 57/375 [00:03<00:13, 24.31it/s]frame loading (JPEG):  16%|████████▍                                           | 61/375 [00:03<00:11, 27.56it/s]frame loading (JPEG):  17%|████████▊                                           | 64/375 [00:03<00:11, 28.09it/s]frame loading (JPEG):  18%|█████████▎                                          | 67/375 [00:03<00:11, 27.55it/s]frame loading (JPEG):  19%|█████████▊                                          | 71/375 [00:03<00:10, 30.01it/s]frame loading (JPEG):  20%|██████████▍                                         | 75/375 [00:03<00:11, 26.08it/s]frame loading (JPEG):  21%|██████████▉                                         | 79/375 [00:04<00:11, 26.42it/s]frame loading (JPEG):  22%|███████████▎                                        | 82/375 [00:04<00:11, 26.34it/s]frame loading (JPEG):  23%|███████████▊                                        | 85/375 [00:04<00:11, 25.01it/s]frame loading (JPEG):  23%|████████████▏                                       | 88/375 [00:04<00:20, 13.87it/s]frame loading (JPEG):  24%|████████████▌                                       | 91/375 [00:04<00:17, 16.26it/s]frame loading (JPEG):  25%|█████████████                                       | 94/375 [00:05<00:15, 17.88it/s]frame loading (JPEG):  26%|█████████████▌                                      | 98/375 [00:05<00:12, 21.80it/s]frame loading (JPEG):  27%|█████████████▋                                     | 101/375 [00:05<00:11, 23.54it/s]frame loading (JPEG):  28%|██████████████▏                                    | 104/375 [00:05<00:11, 22.90it/s]frame loading (JPEG):  29%|██████████████▌                                    | 107/375 [00:05<00:11, 24.13it/s]frame loading (JPEG):  30%|███████████████                                    | 111/375 [00:05<00:09, 27.65it/s]frame loading (JPEG):  30%|███████████████▌                                   | 114/375 [00:05<00:12, 21.72it/s]frame loading (JPEG):  31%|████████████████                                   | 118/375 [00:05<00:10, 24.86it/s]frame loading (JPEG):  32%|████████████████▍                                  | 121/375 [00:06<00:10, 23.93it/s]frame loading (JPEG):  33%|████████████████▊                                  | 124/375 [00:06<00:13, 18.74it/s]frame loading (JPEG):  34%|█████████████████▍                                 | 128/375 [00:06<00:11, 21.07it/s]frame loading (JPEG):  35%|█████████████████▊                                 | 131/375 [00:06<00:13, 18.41it/s]frame loading (JPEG):  36%|██████████████████▏                                | 134/375 [00:06<00:12, 19.76it/s]frame loading (JPEG):  37%|██████████████████▋                                | 137/375 [00:07<00:14, 16.20it/s]frame loading (JPEG):  38%|███████████████████▏                               | 141/375 [00:07<00:11, 19.96it/s]frame loading (JPEG):  38%|███████████████████▌                               | 144/375 [00:07<00:10, 21.14it/s]frame loading (JPEG):  39%|████████████████████▏                              | 148/375 [00:07<00:09, 24.41it/s]frame loading (JPEG):  40%|████████████████████▌                              | 151/375 [00:07<00:09, 23.46it/s]frame loading (JPEG):  41%|████████████████████▉                              | 154/375 [00:07<00:11, 19.77it/s]frame loading (JPEG):  42%|█████████████████████▎                             | 157/375 [00:07<00:10, 20.63it/s]frame loading (JPEG):  43%|█████████████████████▊                             | 160/375 [00:08<00:09, 22.34it/s]frame loading (JPEG):  44%|██████████████████████▎                            | 164/375 [00:08<00:09, 23.06it/s]frame loading (JPEG):  45%|██████████████████████▊                            | 168/375 [00:08<00:07, 26.83it/s]frame loading (JPEG):  46%|███████████████████████▎                           | 171/375 [00:08<00:07, 25.82it/s]frame loading (JPEG):  46%|███████████████████████▋                           | 174/375 [00:08<00:08, 24.87it/s]frame loading (JPEG):  47%|████████████████████████                           | 177/375 [00:08<00:07, 25.47it/s]frame loading (JPEG):  48%|████████████████████████▍                          | 180/375 [00:08<00:08, 22.98it/s]frame loading (JPEG):  49%|█████████████████████████                          | 184/375 [00:08<00:07, 25.79it/s]frame loading (JPEG):  50%|█████████████████████████▍                         | 187/375 [00:09<00:08, 21.90it/s]frame loading (JPEG):  51%|█████████████████████████▊                         | 190/375 [00:09<00:08, 22.72it/s]frame loading (JPEG):  52%|██████████████████████████▍                        | 194/375 [00:09<00:07, 25.77it/s]frame loading (JPEG):  53%|██████████████████████████▉                        | 198/375 [00:09<00:06, 28.00it/s]frame loading (JPEG):  54%|███████████████████████████▌                       | 203/375 [00:09<00:05, 32.32it/s]frame loading (JPEG):  55%|████████████████████████████▏                      | 207/375 [00:09<00:05, 33.33it/s]frame loading (JPEG):  56%|████████████████████████████▋                      | 211/375 [00:09<00:05, 29.77it/s]frame loading (JPEG):  57%|█████████████████████████████▏                     | 215/375 [00:10<00:05, 30.30it/s]frame loading (JPEG):  58%|█████████████████████████████▊                     | 219/375 [00:10<00:05, 27.87it/s]frame loading (JPEG):  59%|██████████████████████████████▎                    | 223/375 [00:10<00:05, 27.11it/s]frame loading (JPEG):  61%|██████████████████████████████▊                    | 227/375 [00:10<00:05, 28.51it/s]frame loading (JPEG):  62%|███████████████████████████████▍                   | 231/375 [00:10<00:04, 30.40it/s]frame loading (JPEG):  63%|███████████████████████████████▉                   | 235/375 [00:10<00:06, 21.89it/s]frame loading (JPEG):  63%|████████████████████████████████▎                  | 238/375 [00:10<00:05, 23.01it/s]frame loading (JPEG):  64%|████████████████████████████████▊                  | 241/375 [00:11<00:05, 24.00it/s]frame loading (JPEG):  65%|█████████████████████████████████▏                 | 244/375 [00:11<00:05, 25.27it/s]frame loading (JPEG):  66%|█████████████████████████████████▌                 | 247/375 [00:11<00:07, 18.06it/s]frame loading (JPEG):  67%|██████████████████████████████████                 | 250/375 [00:11<00:06, 19.14it/s]frame loading (JPEG):  67%|██████████████████████████████████▍                | 253/375 [00:11<00:07, 15.99it/s]frame loading (JPEG):  69%|███████████████████████████████████                | 258/375 [00:12<00:05, 20.41it/s]frame loading (JPEG):  70%|███████████████████████████████████▍               | 261/375 [00:12<00:05, 21.87it/s]frame loading (JPEG):  70%|███████████████████████████████████▉               | 264/375 [00:12<00:05, 20.53it/s]frame loading (JPEG):  71%|████████████████████████████████████▎              | 267/375 [00:12<00:05, 19.03it/s]frame loading (JPEG):  72%|████████████████████████████████████▊              | 271/375 [00:12<00:04, 21.44it/s]frame loading (JPEG):  74%|█████████████████████████████████████▌             | 276/375 [00:12<00:03, 26.26it/s]frame loading (JPEG):  75%|██████████████████████████████████████             | 280/375 [00:12<00:03, 28.32it/s]frame loading (JPEG):  76%|██████████████████████████████████████▌            | 284/375 [00:13<00:03, 28.08it/s]frame loading (JPEG):  77%|███████████████████████████████████████            | 287/375 [00:13<00:03, 28.15it/s]frame loading (JPEG):  78%|███████████████████████████████████████▌           | 291/375 [00:13<00:02, 30.05it/s]frame loading (JPEG):  79%|████████████████████████████████████████           | 295/375 [00:13<00:02, 32.51it/s]frame loading (JPEG):  80%|████████████████████████████████████████▋          | 299/375 [00:13<00:02, 29.10it/s]frame loading (JPEG):  81%|█████████████████████████████████████████▏         | 303/375 [00:13<00:02, 31.04it/s]frame loading (JPEG):  82%|█████████████████████████████████████████▊         | 307/375 [00:13<00:02, 26.89it/s]frame loading (JPEG):  83%|██████████████████████████████████████████▏        | 310/375 [00:13<00:02, 26.91it/s]frame loading (JPEG):  84%|██████████████████████████████████████████▋        | 314/375 [00:14<00:02, 28.96it/s]frame loading (JPEG):  85%|███████████████████████████████████████████▏       | 318/375 [00:14<00:02, 28.25it/s]frame loading (JPEG):  86%|███████████████████████████████████████████▊       | 322/375 [00:14<00:01, 29.71it/s]frame loading (JPEG):  87%|████████████████████████████████████████████▎      | 326/375 [00:14<00:01, 29.56it/s]frame loading (JPEG):  88%|████████████████████████████████████████████▉      | 330/375 [00:14<00:01, 32.06it/s]frame loading (JPEG):  89%|█████████████████████████████████████████████▍     | 334/375 [00:14<00:01, 29.04it/s]frame loading (JPEG):  90%|█████████████████████████████████████████████▉     | 338/375 [00:15<00:02, 15.45it/s]frame loading (JPEG):  91%|██████████████████████████████████████████████▍    | 341/375 [00:15<00:02, 15.04it/s]frame loading (JPEG):  92%|██████████████████████████████████████████████▊    | 344/375 [00:15<00:01, 16.11it/s]frame loading (JPEG):  93%|███████████████████████████████████████████████▏   | 347/375 [00:15<00:01, 17.31it/s]frame loading (JPEG):  93%|███████████████████████████████████████████████▌   | 350/375 [00:15<00:01, 17.91it/s]frame loading (JPEG):  94%|████████████████████████████████████████████████▏  | 354/375 [00:16<00:01, 20.88it/s]frame loading (JPEG):  95%|████████████████████████████████████████████████▋  | 358/375 [00:16<00:00, 23.24it/s]frame loading (JPEG):  97%|█████████████████████████████████████████████████▏ | 362/375 [00:16<00:00, 24.63it/s]frame loading (JPEG):  98%|█████████████████████████████████████████████████▊ | 366/375 [00:16<00:00, 27.24it/s]frame loading (JPEG):  99%|██████████████████████████████████████████████████▍| 371/375 [00:16<00:00, 31.41it/s]frame loading (JPEG): 100%|███████████████████████████████████████████████████| 375/375 [00:16<00:00, 22.55it/s]
add_prompt/video_length 375
/home/gridsan/nchutisilp/projects/segment-anything-2/sam2/sam2_video_predictor.py:961: UserWarning: cannot import name '_C' from 'sam2' (/home/gridsan/nchutisilp/projects/segment-anything-2/sam2/__init__.py)

Skipping the post-processing step due to the error above. You can still use SAM 2 and it's OK to ignore the error above, although some post-processing functionality may be limited (which doesn't affect the results in most cases; see https://github.com/facebookresearch/sam2/blob/main/INSTALL.md).
  pred_masks_gpu = fill_holes_in_mask_scores(
Traceback (most recent call last):
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_consistent_point_prompting.py", line 163, in <module>
    run("configs/sam2.1/sam2.1_hiera_s.yaml", "/home/gridsan/nchutisilp/projects/segment-anything-2/sam2_logs/configs/sam2.1_training/sam2.1_hiera_s_MOSE_finetune_scale4_var1.yaml/checkpoints/checkpoint.pt", "sam2.1_hiera_s_MOSE_finetune_scale4_var1.yaml")
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_consistent_point_prompting.py", line 136, in run
    prompts = add_prompt(video_label, predictor, inference_state, annotation_every_n)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_consistent_point_prompting.py", line 50, in add_prompt
    assert prev_center is not None, f"prev_center should not be None at frame {i} while annotation is every {annotation_every_n} (modulo is {i % annotation_every_n})"
           ^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: prev_center should not be None at frame 103 while annotation is every 4 (modulo is 3)
