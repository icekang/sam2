/home/gridsan/nchutisilp/.conda/envs/sam2/bin/python
/home/gridsan/nchutisilp/projects/segment-anything-2/sam2/modeling/sam/transformer.py:23: UserWarning: Flash Attention is disabled as it requires a GPU with Ampere (8.0) CUDA capability.
  OLD_GPU, USE_FLASH_ATTN, MATH_KERNEL_ON = get_sdpa_settings()
frame loading (JPEG):   0%|                                                                   | 0/375 [00:00<?, ?it/s]frame loading (JPEG):   0%|▏                                                          | 1/375 [00:02<14:07,  2.27s/it]frame loading (JPEG):   1%|▍                                                          | 3/375 [00:02<03:58,  1.56it/s]frame loading (JPEG):   1%|▊                                                          | 5/375 [00:02<02:11,  2.82it/s]frame loading (JPEG):   2%|█                                                          | 7/375 [00:02<01:26,  4.28it/s]frame loading (JPEG):   2%|█▍                                                         | 9/375 [00:02<01:01,  5.98it/s]frame loading (JPEG):   3%|█▋                                                        | 11/375 [00:02<00:48,  7.48it/s]frame loading (JPEG):   3%|██                                                        | 13/375 [00:03<00:40,  8.98it/s]frame loading (JPEG):   4%|██▎                                                       | 15/375 [00:03<00:35, 10.27it/s]frame loading (JPEG):   5%|██▋                                                       | 17/375 [00:03<00:32, 11.12it/s]frame loading (JPEG):   5%|██▉                                                       | 19/375 [00:03<00:28, 12.60it/s]frame loading (JPEG):   6%|███▏                                                      | 21/375 [00:03<00:25, 14.11it/s]frame loading (JPEG):   6%|███▌                                                      | 23/375 [00:03<00:28, 12.45it/s]frame loading (JPEG):   7%|███▊                                                      | 25/375 [00:03<00:26, 13.31it/s]frame loading (JPEG):   7%|████▏                                                     | 27/375 [00:04<00:25, 13.87it/s]frame loading (JPEG):   8%|████▍                                                     | 29/375 [00:04<00:26, 13.04it/s]frame loading (JPEG):   8%|████▊                                                     | 31/375 [00:04<00:24, 14.16it/s]frame loading (JPEG):   9%|█████                                                     | 33/375 [00:04<00:22, 14.92it/s]frame loading (JPEG):   9%|█████▍                                                    | 35/375 [00:04<00:21, 15.76it/s]frame loading (JPEG):  10%|█████▋                                                    | 37/375 [00:04<00:20, 16.40it/s]frame loading (JPEG):  11%|██████▏                                                   | 40/375 [00:04<00:19, 17.43it/s]frame loading (JPEG):  11%|██████▍                                                   | 42/375 [00:04<00:20, 16.32it/s]frame loading (JPEG):  12%|██████▊                                                   | 44/375 [00:05<00:19, 17.13it/s]frame loading (JPEG):  12%|███████                                                   | 46/375 [00:05<00:18, 17.53it/s]frame loading (JPEG):  13%|███████▍                                                  | 48/375 [00:05<00:18, 17.63it/s]frame loading (JPEG):  13%|███████▋                                                  | 50/375 [00:05<00:18, 17.74it/s]frame loading (JPEG):  14%|████████                                                  | 52/375 [00:05<00:20, 16.13it/s]frame loading (JPEG):  14%|████████▎                                                 | 54/375 [00:05<00:20, 15.96it/s]frame loading (JPEG):  15%|████████▋                                                 | 56/375 [00:05<00:19, 16.51it/s]frame loading (JPEG):  15%|████████▉                                                 | 58/375 [00:05<00:18, 17.22it/s]frame loading (JPEG):  16%|█████████▎                                                | 60/375 [00:06<00:18, 17.22it/s]frame loading (JPEG):  17%|█████████▌                                                | 62/375 [00:06<00:21, 14.78it/s]frame loading (JPEG):  17%|█████████▉                                                | 64/375 [00:06<00:20, 15.54it/s]frame loading (JPEG):  18%|██████████▎                                               | 67/375 [00:06<00:18, 16.89it/s]frame loading (JPEG):  18%|██████████▋                                               | 69/375 [00:06<00:18, 16.24it/s]frame loading (JPEG):  19%|███████████▏                                              | 72/375 [00:06<00:17, 17.60it/s]frame loading (JPEG):  20%|███████████▌                                              | 75/375 [00:06<00:16, 18.55it/s]frame loading (JPEG):  21%|███████████▉                                              | 77/375 [00:07<00:16, 18.17it/s]frame loading (JPEG):  21%|████████████▎                                             | 80/375 [00:07<00:15, 19.19it/s]frame loading (JPEG):  22%|████████████▋                                             | 82/375 [00:07<00:21, 13.39it/s]frame loading (JPEG):  22%|████████████▉                                             | 84/375 [00:07<00:20, 14.15it/s]frame loading (JPEG):  23%|█████████████▎                                            | 86/375 [00:07<00:21, 13.15it/s]frame loading (JPEG):  23%|█████████████▌                                            | 88/375 [00:07<00:20, 14.18it/s]frame loading (JPEG):  24%|██████████████                                            | 91/375 [00:07<00:17, 16.39it/s]frame loading (JPEG):  25%|██████████████▍                                           | 93/375 [00:08<00:17, 16.31it/s]frame loading (JPEG):  25%|██████████████▋                                           | 95/375 [00:08<00:16, 16.69it/s]frame loading (JPEG):  26%|███████████████                                           | 97/375 [00:08<00:16, 16.49it/s]frame loading (JPEG):  26%|███████████████▎                                          | 99/375 [00:08<00:18, 15.20it/s]frame loading (JPEG):  27%|███████████████▎                                         | 101/375 [00:08<00:17, 15.96it/s]frame loading (JPEG):  27%|███████████████▋                                         | 103/375 [00:08<00:18, 14.67it/s]frame loading (JPEG):  28%|███████████████▉                                         | 105/375 [00:08<00:17, 15.23it/s]frame loading (JPEG):  29%|████████████████▎                                        | 107/375 [00:09<00:16, 16.10it/s]frame loading (JPEG):  29%|████████████████▋                                        | 110/375 [00:09<00:14, 17.82it/s]frame loading (JPEG):  30%|█████████████████                                        | 112/375 [00:09<00:14, 18.26it/s]frame loading (JPEG):  31%|█████████████████▍                                       | 115/375 [00:09<00:13, 19.36it/s]frame loading (JPEG):  31%|█████████████████▊                                       | 117/375 [00:09<00:13, 19.10it/s]frame loading (JPEG):  32%|██████████████████                                       | 119/375 [00:09<00:14, 17.21it/s]frame loading (JPEG):  32%|██████████████████▍                                      | 121/375 [00:09<00:15, 16.47it/s]frame loading (JPEG):  33%|██████████████████▋                                      | 123/375 [00:09<00:15, 16.63it/s]frame loading (JPEG):  33%|███████████████████                                      | 125/375 [00:10<00:15, 16.06it/s]frame loading (JPEG):  34%|███████████████████▎                                     | 127/375 [00:10<00:15, 16.36it/s]frame loading (JPEG):  34%|███████████████████▌                                     | 129/375 [00:10<00:14, 16.41it/s]frame loading (JPEG):  35%|████████████████████                                     | 132/375 [00:10<00:16, 14.52it/s]frame loading (JPEG):  36%|████████████████████▎                                    | 134/375 [00:10<00:18, 12.85it/s]frame loading (JPEG):  36%|████████████████████▋                                    | 136/375 [00:10<00:17, 13.41it/s]frame loading (JPEG):  37%|████████████████████▉                                    | 138/375 [00:10<00:16, 14.16it/s]frame loading (JPEG):  38%|█████████████████████▍                                   | 141/375 [00:11<00:14, 16.10it/s]frame loading (JPEG):  38%|█████████████████████▉                                   | 144/375 [00:11<00:13, 17.44it/s]frame loading (JPEG):  39%|██████████████████████▏                                  | 146/375 [00:11<00:13, 16.58it/s]frame loading (JPEG):  39%|██████████████████████▍                                  | 148/375 [00:11<00:15, 14.92it/s]frame loading (JPEG):  40%|██████████████████████▊                                  | 150/375 [00:11<00:14, 15.33it/s]frame loading (JPEG):  41%|███████████████████████                                  | 152/375 [00:11<00:14, 15.81it/s]frame loading (JPEG):  41%|███████████████████████▍                                 | 154/375 [00:11<00:15, 14.36it/s]frame loading (JPEG):  42%|███████████████████████▋                                 | 156/375 [00:12<00:14, 15.06it/s]frame loading (JPEG):  42%|████████████████████████▏                                | 159/375 [00:12<00:12, 16.78it/s]frame loading (JPEG):  43%|████████████████████████▍                                | 161/375 [00:12<00:12, 16.97it/s]frame loading (JPEG):  43%|████████████████████████▊                                | 163/375 [00:12<00:12, 17.48it/s]frame loading (JPEG):  44%|█████████████████████████                                | 165/375 [00:12<00:12, 16.69it/s]frame loading (JPEG):  45%|█████████████████████████▍                               | 167/375 [00:12<00:11, 17.49it/s]frame loading (JPEG):  45%|█████████████████████████▋                               | 169/375 [00:12<00:11, 17.75it/s]frame loading (JPEG):  46%|██████████████████████████▏                              | 172/375 [00:12<00:11, 17.63it/s]frame loading (JPEG):  46%|██████████████████████████▍                              | 174/375 [00:13<00:12, 16.59it/s]frame loading (JPEG):  47%|██████████████████████████▊                              | 176/375 [00:13<00:11, 17.32it/s]frame loading (JPEG):  47%|███████████████████████████                              | 178/375 [00:13<00:11, 16.54it/s]frame loading (JPEG):  48%|███████████████████████████▎                             | 180/375 [00:13<00:12, 16.21it/s]frame loading (JPEG):  49%|███████████████████████████▋                             | 182/375 [00:13<00:12, 15.55it/s]frame loading (JPEG):  49%|███████████████████████████▉                             | 184/375 [00:13<00:11, 16.51it/s]frame loading (JPEG):  50%|████████████████████████████▎                            | 186/375 [00:13<00:12, 14.63it/s]frame loading (JPEG):  50%|████████████████████████████▌                            | 188/375 [00:14<00:12, 15.58it/s]frame loading (JPEG):  51%|████████████████████████████▉                            | 190/375 [00:14<00:11, 16.38it/s]frame loading (JPEG):  51%|█████████████████████████████▏                           | 192/375 [00:14<00:11, 15.80it/s]frame loading (JPEG):  52%|█████████████████████████████▍                           | 194/375 [00:14<00:11, 16.21it/s]frame loading (JPEG):  52%|█████████████████████████████▊                           | 196/375 [00:14<00:10, 17.09it/s]frame loading (JPEG):  53%|██████████████████████████████                           | 198/375 [00:14<00:10, 17.54it/s]frame loading (JPEG):  53%|██████████████████████████████▍                          | 200/375 [00:14<00:09, 17.90it/s]frame loading (JPEG):  54%|██████████████████████████████▋                          | 202/375 [00:14<00:10, 16.84it/s]frame loading (JPEG):  54%|███████████████████████████████                          | 204/375 [00:14<00:10, 16.30it/s]frame loading (JPEG):  55%|███████████████████████████████▎                         | 206/375 [00:15<00:09, 17.14it/s]frame loading (JPEG):  55%|███████████████████████████████▌                         | 208/375 [00:15<00:09, 17.11it/s]frame loading (JPEG):  56%|███████████████████████████████▉                         | 210/375 [00:15<00:09, 17.79it/s]frame loading (JPEG):  57%|████████████████████████████████▏                        | 212/375 [00:15<00:09, 18.08it/s]frame loading (JPEG):  57%|████████████████████████████████▌                        | 214/375 [00:15<00:09, 16.14it/s]frame loading (JPEG):  58%|████████████████████████████████▉                        | 217/375 [00:15<00:09, 17.06it/s]frame loading (JPEG):  58%|█████████████████████████████████▎                       | 219/375 [00:15<00:09, 17.00it/s]frame loading (JPEG):  59%|█████████████████████████████████▌                       | 221/375 [00:16<00:10, 14.92it/s]frame loading (JPEG):  59%|█████████████████████████████████▉                       | 223/375 [00:16<00:09, 15.72it/s]frame loading (JPEG):  60%|██████████████████████████████████▎                      | 226/375 [00:16<00:09, 16.50it/s]frame loading (JPEG):  61%|██████████████████████████████████▋                      | 228/375 [00:16<00:09, 15.78it/s]frame loading (JPEG):  61%|██████████████████████████████████▉                      | 230/375 [00:16<00:08, 16.36it/s]frame loading (JPEG):  62%|███████████████████████████████████▎                     | 232/375 [00:16<00:08, 17.22it/s]frame loading (JPEG):  62%|███████████████████████████████████▌                     | 234/375 [00:16<00:08, 17.21it/s]frame loading (JPEG):  63%|███████████████████████████████████▊                     | 236/375 [00:16<00:07, 17.67it/s]frame loading (JPEG):  63%|████████████████████████████████████▏                    | 238/375 [00:16<00:07, 18.19it/s]frame loading (JPEG):  64%|████████████████████████████████████▍                    | 240/375 [00:17<00:07, 17.52it/s]frame loading (JPEG):  65%|████████████████████████████████████▊                    | 242/375 [00:17<00:07, 17.65it/s]frame loading (JPEG):  65%|█████████████████████████████████████                    | 244/375 [00:17<00:07, 17.58it/s]frame loading (JPEG):  66%|█████████████████████████████████████▍                   | 246/375 [00:17<00:07, 17.63it/s]frame loading (JPEG):  66%|█████████████████████████████████████▋                   | 248/375 [00:17<00:07, 16.67it/s]frame loading (JPEG):  67%|██████████████████████████████████████                   | 250/375 [00:17<00:09, 13.39it/s]frame loading (JPEG):  67%|██████████████████████████████████████▎                  | 252/375 [00:17<00:08, 13.70it/s]frame loading (JPEG):  68%|██████████████████████████████████████▌                  | 254/375 [00:18<00:08, 13.88it/s]frame loading (JPEG):  68%|██████████████████████████████████████▉                  | 256/375 [00:18<00:08, 13.26it/s]frame loading (JPEG):  69%|███████████████████████████████████████▎                 | 259/375 [00:18<00:08, 14.13it/s]frame loading (JPEG):  70%|███████████████████████████████████████▋                 | 261/375 [00:18<00:07, 15.15it/s]frame loading (JPEG):  70%|███████████████████████████████████████▉                 | 263/375 [00:18<00:06, 16.11it/s]frame loading (JPEG):  71%|████████████████████████████████████████▎                | 265/375 [00:18<00:06, 15.87it/s]frame loading (JPEG):  71%|████████████████████████████████████████▌                | 267/375 [00:18<00:06, 16.22it/s]frame loading (JPEG):  72%|████████████████████████████████████████▉                | 269/375 [00:18<00:06, 16.02it/s]frame loading (JPEG):  72%|█████████████████████████████████████████▏               | 271/375 [00:19<00:06, 15.39it/s]frame loading (JPEG):  73%|█████████████████████████████████████████▍               | 273/375 [00:19<00:06, 15.45it/s]frame loading (JPEG):  73%|█████████████████████████████████████████▊               | 275/375 [00:19<00:06, 16.14it/s]frame loading (JPEG):  74%|██████████████████████████████████████████               | 277/375 [00:19<00:06, 15.21it/s]frame loading (JPEG):  74%|██████████████████████████████████████████▍              | 279/375 [00:19<00:06, 15.44it/s]frame loading (JPEG):  75%|██████████████████████████████████████████▋              | 281/375 [00:19<00:05, 16.22it/s]frame loading (JPEG):  75%|███████████████████████████████████████████              | 283/375 [00:19<00:05, 16.87it/s]frame loading (JPEG):  76%|███████████████████████████████████████████▎             | 285/375 [00:20<00:05, 15.46it/s]frame loading (JPEG):  77%|███████████████████████████████████████████▌             | 287/375 [00:20<00:05, 16.47it/s]frame loading (JPEG):  77%|███████████████████████████████████████████▉             | 289/375 [00:20<00:05, 15.64it/s]frame loading (JPEG):  78%|████████████████████████████████████████████▏            | 291/375 [00:20<00:05, 16.38it/s]frame loading (JPEG):  78%|████████████████████████████████████████████▌            | 293/375 [00:20<00:04, 16.93it/s]frame loading (JPEG):  79%|████████████████████████████████████████████▊            | 295/375 [00:20<00:04, 16.61it/s]frame loading (JPEG):  79%|█████████████████████████████████████████████▏           | 297/375 [00:20<00:04, 16.69it/s]frame loading (JPEG):  80%|█████████████████████████████████████████████▍           | 299/375 [00:20<00:04, 16.15it/s]frame loading (JPEG):  80%|█████████████████████████████████████████████▊           | 301/375 [00:20<00:04, 16.54it/s]frame loading (JPEG):  81%|██████████████████████████████████████████████           | 303/375 [00:21<00:04, 16.06it/s]frame loading (JPEG):  81%|██████████████████████████████████████████████▎          | 305/375 [00:21<00:04, 15.87it/s]frame loading (JPEG):  82%|██████████████████████████████████████████████▋          | 307/375 [00:21<00:04, 14.82it/s]frame loading (JPEG):  82%|██████████████████████████████████████████████▉          | 309/375 [00:21<00:04, 15.18it/s]frame loading (JPEG):  83%|███████████████████████████████████████████████▎         | 311/375 [00:21<00:04, 15.81it/s]frame loading (JPEG):  83%|███████████████████████████████████████████████▌         | 313/375 [00:21<00:03, 16.64it/s]frame loading (JPEG):  84%|███████████████████████████████████████████████▉         | 315/375 [00:21<00:03, 16.14it/s]frame loading (JPEG):  85%|████████████████████████████████████████████████▏        | 317/375 [00:21<00:03, 16.02it/s]frame loading (JPEG):  85%|████████████████████████████████████████████████▍        | 319/375 [00:22<00:03, 16.04it/s]frame loading (JPEG):  86%|████████████████████████████████████████████████▊        | 321/375 [00:22<00:03, 16.13it/s]frame loading (JPEG):  86%|█████████████████████████████████████████████████        | 323/375 [00:22<00:03, 16.86it/s]frame loading (JPEG):  87%|█████████████████████████████████████████████████▍       | 325/375 [00:22<00:02, 17.04it/s]frame loading (JPEG):  87%|█████████████████████████████████████████████████▋       | 327/375 [00:22<00:02, 17.04it/s]frame loading (JPEG):  88%|██████████████████████████████████████████████████       | 329/375 [00:22<00:02, 17.18it/s]frame loading (JPEG):  89%|██████████████████████████████████████████████████▍      | 332/375 [00:22<00:02, 18.31it/s]frame loading (JPEG):  89%|██████████████████████████████████████████████████▊      | 334/375 [00:22<00:02, 18.01it/s]frame loading (JPEG):  90%|███████████████████████████████████████████████████      | 336/375 [00:23<00:02, 16.60it/s]frame loading (JPEG):  90%|███████████████████████████████████████████████████▍     | 338/375 [00:23<00:02, 16.17it/s]frame loading (JPEG):  91%|███████████████████████████████████████████████████▋     | 340/375 [00:23<00:02, 16.54it/s]frame loading (JPEG):  91%|███████████████████████████████████████████████████▉     | 342/375 [00:23<00:01, 16.93it/s]frame loading (JPEG):  92%|████████████████████████████████████████████████████▎    | 344/375 [00:23<00:01, 16.29it/s]frame loading (JPEG):  92%|████████████████████████████████████████████████████▌    | 346/375 [00:23<00:01, 16.38it/s]frame loading (JPEG):  93%|████████████████████████████████████████████████████▉    | 348/375 [00:23<00:01, 16.99it/s]frame loading (JPEG):  94%|█████████████████████████████████████████████████████▎   | 351/375 [00:23<00:01, 18.23it/s]frame loading (JPEG):  94%|█████████████████████████████████████████████████████▋   | 353/375 [00:24<00:01, 17.37it/s]frame loading (JPEG):  95%|██████████████████████████████████████████████████████   | 356/375 [00:24<00:01, 17.84it/s]frame loading (JPEG):  95%|██████████████████████████████████████████████████████▍  | 358/375 [00:24<00:01, 15.98it/s]frame loading (JPEG):  96%|██████████████████████████████████████████████████████▋  | 360/375 [00:24<00:00, 15.36it/s]frame loading (JPEG):  97%|███████████████████████████████████████████████████████▏ | 363/375 [00:24<00:00, 16.44it/s]frame loading (JPEG):  97%|███████████████████████████████████████████████████████▍ | 365/375 [00:24<00:00, 16.03it/s]frame loading (JPEG):  98%|███████████████████████████████████████████████████████▉ | 368/375 [00:25<00:00, 16.86it/s]frame loading (JPEG):  99%|████████████████████████████████████████████████████████▏| 370/375 [00:25<00:00, 16.91it/s]frame loading (JPEG):  99%|████████████████████████████████████████████████████████▌| 372/375 [00:25<00:00, 16.91it/s]frame loading (JPEG): 100%|████████████████████████████████████████████████████████▊| 374/375 [00:25<00:00, 15.29it/s]frame loading (JPEG): 100%|█████████████████████████████████████████████████████████| 375/375 [00:25<00:00, 14.72it/s]
add_prompt/video_length 375
Traceback (most recent call last):
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_negative_points.py", line 193, in <module>
    run("configs/sam2.1/sam2.1_hiera_s.yaml", "/home/gridsan/nchutisilp/projects/segment-anything-2/sam2_logs/configs/sam2.1_training/sam2.1_hiera_s_MOSE_finetune_scale4_var1.yaml/checkpoints/checkpoint.pt", "sam2.1_hiera_s_MOSE_finetune_scale4_var1.yaml")
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_negative_points.py", line 166, in run
    prompts = add_prompt(video_label, negative_video_label, predictor, inference_state, annotation_every_n)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gridsan/nchutisilp/projects/segment-anything-2/notebooks/evaluate_finetuned_sam2_negative_points.py", line 53, in add_prompt
    negative_prompts = np.array(random.choice(negative_mask_coords, k=n_sample_points))
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Random.choice() got an unexpected keyword argument 'k'
